# ==================== Web 服务器配置 ====================
# Web 服务器端口（前端访问端口：http://localhost:<SERVER_PORT>）
SERVER_PORT=8080
# 服务器超时配置（秒）
SERVER_READ_TIMEOUT=30
SERVER_WRITE_TIMEOUT=30
SERVER_IDLE_TIMEOUT=120

# 后端API配置
BACKEND_HOST=127.0.0.1
BACKEND_PORT=8000
BACKEND_STARTUP_TIMEOUT=60 # 第1次运行，如果启动失败可调大超时间，如：180
BACKEND_HEALTH_CHECK_INTERVAL=5
BACKEND_HEALTH_CHECK_PATH=/api/v1/health

# ==================== 应用程序基础配置 ====================
APP_NAME=智能数据库监控系统
APP_VERSION=1.0.1
ENVIRONMENT=production # production/development
DEBUG=false # 关闭 SQLAlchemy SQL 日志打印、 关闭 Swagger 文档访问 (/docs, /redoc)
LOG_LEVEL=INFO # 应用日志
LOG_FILE=logs/app.log
API_V1_STR=/api/v1
DATA_DIR=./data  # FIASS向量数据库目录

# MySQL 数据库配置
MYSQL_HOST=xxx.xxx.xxx.xxx
MYSQL_PORT=3306
MYSQL_USER=xxxxxxxxxxx
MYSQL_PASSWORD=xxxxxxxxxxx
MYSQL_DATABASE=db_prediction

# Redis 缓存配置
REDIS_HOST=xxx.xxx.xxx.xxx
REDIS_PORT=6379
REDIS_PASSWORD=xxxxxxxxxxx # Redis密码
REDIS_DB=0

# Prometheus 配置
PROMETHEUS_API_URL=http://xxxxxxxxxxxxxxx.com/select/0/prometheus/
PROMETHEUS_API_VERSION=v1

# ==================== LLM 配置：openai/deepseek/claude ====================
# LLM 提供商：openai、deepseek、claude、local
LLM_PROVIDER=deepseek

# OpenAI 配置
LLM_API_KEY=test_api_key
LLM_BASE_URL=https://api.openai.com/v1
LLM_MODEL=gpt-3.5-turbo
LLM_MAX_TOKENS=2000
LLM_TEMPERATURE=0.3

# DeepSeek 配置
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_MODEL=deepseek-chat

# Claude 配置
CLAUDE_API_KEY=
CLAUDE_BASE_URL=https://api.anthropic.com/v1
CLAUDE_MODEL=claude-4-sonnet

# ==================== 算法配置 ====================
# DTW 配置
DTW_RADIUS=10
DTW_STEP_PATTERN=symmetric2
# DTW基线天数配置（支持动态调整）
DTW_BASELINE_DAYS_MIN=3 # 最少基线天数
DTW_BASELINE_DAYS_MAX=15 # 最大基线天数
DTW_MIN_BASELINE_PATTERNS=3 # 最少基线模式数
DTW_ANOMALY_THRESHOLD=0.3 # 异常阈值

# FAISS 配置
FAISS_INDEX_TYPE=flat
FAISS_DIMENSION=128
# 向量索引构建配置
VECTOR_INDEX_BUILD_ENABLED=true
VECTOR_INDEX_BUILD_INTERVAL=3600
VECTOR_INDEX_LOOKBACK_DAYS=7
VECTOR_INDEX_MIN_SAMPLES=10 # 最小数据样本条数

# 预测配置
PREDICTION_WINDOW_MINUTES=5
PREDICTION_ACCURACY_TARGET=0.8

# 测试数据库配置
TEST_DATABASE_URL=sqlite+aiosqlite:///./test.db

# ==================== 趋势分析器配置 ====================

# 是否使用增强版趋势分析器（true/false）
# true: 启用增强版(支持周期性检测、异常值过滤、自适应预测)
# false: 使用标准版(仅线性回归)
USE_ENHANCED_TREND_ANALYZER=true

# 周期性检测阈值（0.0-1.0）
# 0.3表示周期性功率占比>30%才认为有周期性
# 仅在启用增强版时生效
TREND_ANALYZER_PERIODICITY_THRESHOLD=0.3

# 异常值IQR倍数（建议1.5-3.0）
# 1.5是标准值,用于过滤异常数据点
# 仅在启用增强版时生效
TREND_ANALYZER_OUTLIER_IQR_MULTIPLIER=1.5

# ==================== 历史同期预测配置 ====================

# 历史同期预测数据天数（1-90天）
# 从Prometheus读取历史数据的天数,默认15天
# Prometheus保留最近15天的每分钟数据,数据质量更好
HISTORICAL_PATTERN_DAYS=15

# 历史同期预测最小样本数（建议30-100）
# 样本数不足时将使用其他预测方法
# 15天*24小时=360个样本,50个约占14%
HISTORICAL_PATTERN_MIN_SAMPLES=50

# 历史同期预测时间衰减因子（天,建议3-14天）
# 用于计算历史数据权重,越近的数据权重越高
# 7天为一周周期,符合业务规律
HISTORICAL_PATTERN_DECAY_DAYS=7.0

# 历史同期预测是否匹配星期（true/false）
# true=区分工作日/周末模式,false=不区分
# 建议启用,因为工作日和周末的负载模式通常不同
HISTORICAL_PATTERN_MATCH_WEEKDAY=true

# ==================== 预测去重配置 ====================

# 是否启用预测去重（true/false）
ENABLE_PREDICTION_DEDUP=true

# 预测去重窗口（秒）
# 在此时间窗口内，同一实例不会重复预测
PREDICTION_DEDUP_WINDOW=60

# 预测分布式锁超时（秒）
# 防止锁永久占用
PREDICTION_LOCK_TIMEOUT=30

# ==================== 预测分析配置 ====================

# 预测任务调度间隔（秒）
PREDICTION_INTERVAL=300

# 预测数据窗口（分钟）
PREDICTION_DATA_WINDOW=30

# 最大并发预测数
PREDICTION_MAX_CONCURRENT=10

# 黑名单最大失败次数
BLACKLIST_MAX_FAILURES=3

# 黑名单持续时间（秒）
BLACKLIST_DURATION=1800


# ==================== Mock数据配置 ====================

# 是否启用Mock数据（true/false）
# true: 所有API请求返回Mock数据，无需连接数据库
# false: 使用真实数据库数据
USE_MOCK_DATA=false

# Mock数据随机种子
# 相同的种子会生成相同的Mock数据，便于测试复现
MOCK_DATA_SEED=42

# Mock响应延迟（秒）
# 模拟网络延迟，用于测试加载状态
# 0: 无延迟
# 0.1-1.0: 模拟正常网络延迟
# >1.0: 模拟慢速网络
MOCK_RESPONSE_DELAY=0.1

# ==================== 性能监控配置 ====================

# 是否启用性能监控（true/false）
ENABLE_PERFORMANCE_MONITOR=true

# 性能监控滑动窗口大小（记录数）
PERFORMANCE_MONITOR_WINDOW_SIZE=1000

# 指标缓存TTL（小时）
PERFORMANCE_MONITOR_CACHE_TTL_HOURS=1

